{"version":3,"sources":["webpack:///path---angular-firebase-send-push-notifications-2777da08bb9a4215c7d4.js","webpack:///./.cache/json/angular-firebase-send-push-notifications.json"],"names":["webpackJsonp","874","module","exports","data","post","id","html","fields","slug","prefix","frontmatter","title","subTitle","cover","childImageSharp","resize","src","author","footnote","site","siteMetadata","facebook","appId","pathContext"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,MAAQC,GAAA,sKAAAC,KAAA;AAAmvxCC,QAA6tDC,KAAA,6CAAAC,OAAA,cAA0EC,aAAgBC,MAAA,yCAAAC,SAAA,GAAAC,OAAwEC,iBAAmBC,QAAUC,IAAA,wEAA6EC,QAAWZ,GAAA,kHAAAC,KAAA,sGAAmOY,UAAab,GAAA,oHAAAC,KAAA,0DAA2La,MAASC,cAAgBC,UAAYC,MAAA,sBAA6BC,aAAgBf,KAAA","file":"path---angular-firebase-send-push-notifications-2777da08bb9a4215c7d4.js","sourcesContent":["webpackJsonp([248565452126349],{\n\n/***/ 874:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"post\":{\"id\":\"/Users/leejuseung/Work/blog/lighthouse-dev.github.io/content/posts/2019-12-22--angular-firebase-send-push-notifications/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<h1>ã¯ã˜ã‚ã«</h1>\\n<p>ã“ã‚“ã«ã¡ã¯ï¼</p>\\n<p><a href=\\\"https://qiita.com/advent-calendar/2017/fusic\\\">å»å¹´</a>ã«å¼•ãç¶šãã€ä»Šå¹´ã‚‚æ›¸ãã¾ã™ã€‚</p>\\n<p><a href=\\\"https://qiita.com/advent-calendar/2018/fusic\\\">Fusic Advent Calendar 2018</a> 19æ—¥ç›®ã®è¨˜äº‹ã§ã™ï¼</p>\\n<p>ä»Šå›ã¯ã€ã€ŒAngular + Firebase + PWAã§Pushé€šçŸ¥æ©Ÿèƒ½ã‚’å®Ÿè£…ã€ã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸ ğŸ‘</p>\\n<br>\\n<h1>ã‚„ã‚ŠãŸã„ã“ã¨</h1>\\n<p>PWAã§Pushæ©Ÿèƒ½å®Ÿè£…ã—ãŸã„ï¼</p>\\n<p>â€» PWAã£ã¦ä½•ï¼Ÿçš„ãªèª¬æ˜ã¯ã€ä»¥ä¸‹ã‚’è¦‹ã¦ãã ã•ã„</p>\\n<ul>\\n<li><a href=\\\"https://developers.google.com/web/fundamentals/codelabs/your-first-pwapp/?hl=ja\\\">https://developers.google.com/web/fundamentals/codelabs/your-first-pwapp/?hl=ja</a></li>\\n<li><a href=\\\"https://developers.google.com/web/progressive-web-apps/\\\">https://developers.google.com/web/progressive-web-apps/</a></li>\\n</ul>\\n<br>\\n<h1>é–‹ç™ºç’°å¢ƒ</h1>\\n<ul>\\n<li>Angular 6</li>\\n<li>\\n<p>Firebase</p>\\n<ul>\\n<li>Realtime Database</li>\\n<li>Functions</li>\\n</ul>\\n</li>\\n</ul>\\n<br>\\n<h1>ã•ã£ããå®Ÿè£…ã«å…¥ã‚Šã¾ã—ã‚‡ã† ğŸ¤©</h1>\\n<p>å®Ÿè£…ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®æµã‚Œã§èª¬æ˜ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ï¼</p>\\n<ol>\\n<li>å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãªã©ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</li>\\n<li>Pushæ©Ÿèƒ½å®Ÿè£…ï¼šã‚¢ãƒ—ãƒªå´</li>\\n<li>Pushæ©Ÿèƒ½å®Ÿè£…ï¼šFirebase Functionså´</li>\\n</ol>\\n<h2>1. å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãªã©ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h2>\\n<p><strong>Firebase CLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-cmd\\\"><code class=\\\"language-cmd\\\">yarn global add firebase-tools@latest</code></pre>\\n      </div>\\n<p>â€» Firebase CLIã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€<a href=\\\"https://firebase.google.com/docs/cli/?hl=ja\\\">ã“ã¡ã‚‰</a>ã‚’è¦‹ã¦ä¸‹ã•ã„ï¼</p>\\n<p><strong>Firebaseãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-cmd\\\"><code class=\\\"language-cmd\\\">yarn add firebase --save</code></pre>\\n      </div>\\n<p><a href=\\\"https://www.npmjs.com/package/firebase\\\">https://www.npmjs.com/package/firebase</a></p>\\n<br>\\n<h2>2. Pushæ©Ÿèƒ½å®Ÿè£…ï¼šã‚¢ãƒ—ãƒªå´</h2>\\n<h3>2-1. manifest.jsonã‚’ä¿®æ­£</h3>\\n<p>ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰å€¤ <code class=\\\"language-text\\\">gcm_sender_id</code> ã‚’æŒ‡å®šã™ã‚‹ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒª ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>\\n<blockquote>\\n<p>ã€Œãƒ–ãƒ©ã‚¦ã‚¶é€ä¿¡è€… IDã€ã¨ã€Firebase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šã«ç¤ºã•ã‚Œã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®é€ä¿¡è€… ID å€¤ã¨ã‚’æ··åŒã—ãªã„ã§ãã ã•ã„ã€‚\\nmanifest.json ã®ãƒ–ãƒ©ã‚¦ã‚¶é€ä¿¡è€… ID ã¯å›ºå®šå€¤ã§ã€ã™ã¹ã¦ã® FCM JavaScript ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§å…±é€šã§ã™ã€‚</p>\\n</blockquote>\\n<p> <code class=\\\"language-text\\\">gcm_sender_id</code>ã¯ã€å›ºå®šå€¤ã§ã™ã®ã§ã€å¤‰æ›´ã—ãªã„ã§ãã ã•ã„ï¼</p>\\n<p>â–¼ src/manifest.json</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code class=\\\"language-json\\\"><span class=\\\"token punctuation\\\">{</span>\\n  ... çœç•¥ ...\\n  <span class=\\\"token property\\\">\\\"gcm_sender_id\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"103953800507\\\"</span> // â† gcm_sender_idã‚’è¿½åŠ \\n  ... çœç•¥ ...\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<h3>2-2. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚’ä½œæˆ</h3>\\n<p>Pushãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã¯ã€ <code class=\\\"language-text\\\">service worker</code> ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚\\nã¾ãšã€Firebaseã§ <code class=\\\"language-text\\\">messagingSenderId</code>ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚\\nj</p>\\n\\n  <a class=\\\"gatsby-resp-image-link\\\" href=\\\"/static/image-1-2942bf1f0d78ee14e610bf7e0b5d43b9-6eb54.png\\\" style=\\\"display: block\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\">\\n  \\n  <span class=\\\"gatsby-resp-image-wrapper\\\" style=\\\"position: relative; display: block; margin-left: 0 !important; max-width: 800px; margin-left: auto; margin-right: auto;\\\">\\n    <span class=\\\"gatsby-resp-image-background-image\\\" style=\\\"padding-bottom: 74.63330457290768%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACo0lEQVQ4y5WTy24SURjHeQJ9AVcmWvsYLurGbWtStY0bbQXKDMMwUBtsNKm00tobt6YwMDPMDWa4VgreEo3v9fc7B0qLrQsXv3zn+j/f7QRuPRZwmwjMhUc8+k/m/mLxhYynK0ncWxAw+0TAA8ZChDMzH7kcE7Nje3/+khm+JkwIrIkSgkIMkajMEaQ4xJiCKCHFk5yonCCUaWIjK9J5fm98PxAUZITEEa/CIra2MzAtC5puoFRWUVZVGDUTbr0Ox53G830cZfPkBHt8nR5IMsEY95ALhkRkPh3g7KyHVqsFv9lEs9VEu91Gp9PhtDvjcbeLwWCA01KZIkpAVt4gRqIBJnQhuEIeftghD80GLMOEZRGOzanZ1sSatk1ROPA8D9lcnsL/hyALOZ3Zg1rRcFIoQjcMaDUD5ZoG3apBNw3YjoM6he+6LhqeT4KFmwXDZF+S4H5mF75eReWkCN+1SECHY5EgiVZqOs3tieB5x6eHR4LxxMZNglEcpnfwXdcwqFbw1dDwzTbw0zXh2SYVgrwjISbmkKdKsY7NvRxEVmUSZcW5nkMK2W54PE8WXTJsF4bboDUfVt2DS3s+VZflL621sHWQRzASnXTKpYfRUZX39g9x3v/Mq3zW68HpDqA1+9BbfXi9c3wZDjEcDtDt9/H71w+o1Sr1n8JzKLG2uerh6pqEjbfvkMsXeLKZPcgWkD7M4YjmBSrUx+Msty21jNpREYWdXcgkNFWUadEowjRm+YgRS2EJd5+tIijGCRl3lhaxHFqDmt7G8cNVlF6nkEqlqKnXr7fNxZh1PauaktxAhESXgwL3gFXzeTCMEJ3Zfb+F0/0TlCiHqcQ6JNqXr3oYGosGx96xb8R+gMi+Ff/fCY5Ec2aTtLapJLApjyIRx+f/AANl6wIhgsLkAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\\\">\\n      <img class=\\\"gatsby-resp-image-image\\\" style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\" alt=\\\"image 1\\\" title=\\\"\\\" src=\\\"/static/image-1-2942bf1f0d78ee14e610bf7e0b5d43b9-40b6f.png\\\" srcset=\\\"/static/image-1-2942bf1f0d78ee14e610bf7e0b5d43b9-9039c.png 200w,\\n/static/image-1-2942bf1f0d78ee14e610bf7e0b5d43b9-9db44.png 400w,\\n/static/image-1-2942bf1f0d78ee14e610bf7e0b5d43b9-40b6f.png 800w,\\n/static/image-1-2942bf1f0d78ee14e610bf7e0b5d43b9-6eb54.png 1159w\\\" sizes=\\\"(max-width: 800px) 100vw, 800px\\\">\\n    </span>\\n  </span>\\n  \\n  </a>\\n    \\n<p>æ¬¡ã¯ã€<code class=\\\"language-text\\\">src</code>ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®é…ä¸‹ã« <code class=\\\"language-text\\\">firebase-messaging-sw.js</code> ã‚’ä½œæˆã—ã¾ã™ã€‚</p>\\n<p>ãã—ã¦ã€â†‘ã§ã‚³ãƒ”ãƒ¼ã—ãŸ<code class=\\\"language-text\\\">messagingSenderId</code> ã‚’ã€ä»¥ä¸‹ã® <code class=\\\"language-text\\\">firebase.initializeApp()</code> ã«è²¼ã‚Šã¤ã‘ã¾ã™ï¼</p>\\n<p>â–¼ src/firebase-messaging-sw.js</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token comment\\\">// Give the service worker access to Firebase Messaging.</span>\\n<span class=\\\"token comment\\\">// Note that you can only use Firebase Messaging here, other Firebase libraries</span>\\n<span class=\\\"token comment\\\">// are not available in the service worker.</span>\\n<span class=\\\"token function\\\">importScripts</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'https://www.gstatic.com/firebasejs/5.5.0/firebase-app.js'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token function\\\">importScripts</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'https://www.gstatic.com/firebasejs/5.5.0/firebase-messaging.js'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    \\n<span class=\\\"token comment\\\">// Initialize the Firebase app in the service worker by passing in the</span>\\n<span class=\\\"token comment\\\">// messagingSenderId.</span>\\nfirebase<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">initializeApp</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n  messagingSenderId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">''</span> <span class=\\\"token comment\\\">// â†‘ã§ã‚³ãƒ”ãƒ¼ã—ãŸmessagingSenderIdã‚’è¿½åŠ </span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    \\n<span class=\\\"token comment\\\">// Retrieve an instance of Firebase Messaging so that it can handle background</span>\\n<span class=\\\"token comment\\\">// messages.</span>\\n<span class=\\\"token keyword\\\">const</span> messaging <span class=\\\"token operator\\\">=</span> firebase<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">messaging</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmessaging<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setBackgroundMessageHandler</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span>payload<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">const</span> notificationTitle <span class=\\\"token operator\\\">=</span> payload<span class=\\\"token punctuation\\\">.</span>notification<span class=\\\"token punctuation\\\">.</span>title<span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">const</span> notificationOptions <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n    body<span class=\\\"token punctuation\\\">:</span> payload<span class=\\\"token punctuation\\\">.</span>notification<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">,</span>\\n    icon<span class=\\\"token punctuation\\\">:</span> payload<span class=\\\"token punctuation\\\">.</span>notification<span class=\\\"token punctuation\\\">.</span>icon\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token keyword\\\">return</span> self<span class=\\\"token punctuation\\\">.</span>registration<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">showNotification</span><span class=\\\"token punctuation\\\">(</span>notificationTitle<span class=\\\"token punctuation\\\">,</span> notificationOptions<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\nself<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">addEventListener</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'install'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span>event<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Service Worker installing.'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\nself<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">addEventListener</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'activate'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span>event<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Service Worker activating.'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>ã“ã‚Œã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ãƒ—ãƒªã‚’é–‰ã˜ã¦ã‚‚ã€ã‚¢ãƒ—ãƒªãŒæ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ¤œçŸ¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼</p>\\n<h3>2-3. angular.jsonã‚’ä¿®æ­£</h3>\\n<p>angular.jsonã«<code class=\\\"language-text\\\">manifest.json</code>, <code class=\\\"language-text\\\">firebase-messaging-sw.js</code> ã‚’è¿½åŠ </p>\\n<p>â–¼ angular.json</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code class=\\\"language-json\\\"><span class=\\\"token punctuation\\\">{</span>\\n  ... çœç•¥ ...\\n  <span class=\\\"token property\\\">\\\"projects\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token property\\\">\\\"architect\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token property\\\">\\\"build\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">\\\"options\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token property\\\">\\\"assets\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n            <span class=\\\"token string\\\">\\\"src/favicon.ico\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n            <span class=\\\"token string\\\">\\\"src/assets\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n            <span class=\\\"token string\\\">\\\"src/manifest.json\\\"</span><span class=\\\"token punctuation\\\">,</span> // â†è¿½åŠ \\n            <span class=\\\"token string\\\">\\\"src/firebase-messaging-sw.js\\\"</span> // â†è¿½åŠ \\n          <span class=\\\"token punctuation\\\">]</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<h3>2-4. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œæˆ</h3>\\n<p>ã¾ãšã¯ã€Firebaseã®ã€Œéµãƒšã‚¢ã€ã‚’ç”Ÿæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>\\n<h4>2-4-1. Firebaseã§ã€Œéµãƒšã‚¢ã€ã‚’ç”Ÿæˆ</h4>\\n<p>ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šï¼ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã€ã«å…¥ã£ã¦ã€éµãƒšã‚¢ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚</p>\\n\\n  <a class=\\\"gatsby-resp-image-link\\\" href=\\\"/static/image-2-694ee39e36a729fdf3a2bde5a0a1977e-4dcde.png\\\" style=\\\"display: block\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\">\\n  \\n  <span class=\\\"gatsby-resp-image-wrapper\\\" style=\\\"position: relative; display: block; margin-left: 0 !important; max-width: 800px; margin-left: auto; margin-right: auto;\\\">\\n    <span class=\\\"gatsby-resp-image-background-image\\\" style=\\\"padding-bottom: 78.64493996569468%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACOElEQVQ4y6WTy2oUQRSGWwTXgiufRHDvzncQ3JgYjBPxtowJiQYRFJlkQhgcTYaZ6a5rd1VfjKMufK/fc6ovdCYiiIuPv8/p7r9O1TkVXXt0imj9M6KHXxBtnOHKxul/Ed0czHH9icKNQYyra2S8flazxgs1rPV0lQc9ON4/0did5Ngbp3h5uMDmYYLHQ9JhjC16HnBMbB3Vujm8yNNRghfHCZ6N6veRMQpGS0IhtQaO4lQJZJTLU9Phrb4Q5/RtSTqeK7ydCBxNJTKjEc2FRsssUUiUhrYW2lgobSApZm3jFkkYY/BqLHH/Q4LnxwJT+j+KpUbLQijYNIX3HnmeB1VKQQgRlNFaB6M2XpY5fi0r/KgKJOTRGKrO0FAlKZk654JhlmUhZmX6i9WawxGZ88HjkmHYjqTzIEM2dfQj/+xanK/zK/BinSEbMfw8TyRmsehy/0pn2KmQdBYyNEM2Dairyxs80swF2pz/25YNHbqjEeERcKZWxR1u0RaCFmNW85e2zF16N4mxfRJj75PAzljgDc1YrOoxEaSCDQnZaAe9WzHUYQzuvY9xe2eOO/sL3Nqe4e5BDGlTmkOaO5rPsiyRM0WJgrpcFEwROv7HsXF0A869xVfX4FNYyvG2TJqFjn7PLb5luhulllBhv8Os3Ay+FVyRMvUN8bR6SVUUVFlJzXg9+4mD6RIFNYJzXCF/02uK7s2hpopsGHC+EbbZZlVVtNWKbpLHx8U5RguKqdqS8vyuoCNgj99yop6cK27sYQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\\\">\\n      <img class=\\\"gatsby-resp-image-image\\\" style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\" alt=\\\"image 2\\\" title=\\\"\\\" src=\\\"/static/image-2-694ee39e36a729fdf3a2bde5a0a1977e-40b6f.png\\\" srcset=\\\"/static/image-2-694ee39e36a729fdf3a2bde5a0a1977e-9039c.png 200w,\\n/static/image-2-694ee39e36a729fdf3a2bde5a0a1977e-9db44.png 400w,\\n/static/image-2-694ee39e36a729fdf3a2bde5a0a1977e-40b6f.png 800w,\\n/static/image-2-694ee39e36a729fdf3a2bde5a0a1977e-4dcde.png 1166w\\\" sizes=\\\"(max-width: 800px) 100vw, 800px\\\">\\n    </span>\\n  </span>\\n  \\n  </a>\\n    \\n<p>ç”Ÿæˆã—ãŸéµãƒšã‚¢ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãŠã„ã¦ãã ã•ã„â­ï¸</p>\\n<h4>2-4-2. Serviceä½œæˆ</h4>\\n<p>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€Pushé€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘å–ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¨±å¯ã‚’å¾—ã‚‹å½¹å‰²ã‚’ã—ã¾ã™ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-cmd\\\"><code class=\\\"language-cmd\\\">ng g service messaging</code></pre>\\n      </div>\\n<p>ã–ã£ãã‚Šä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹æˆã«ãªã‚Šã¾ã™ï¼</p>\\n<h5>getPermission()</h5>\\n<p>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰Pushé€šçŸ¥ã‚’è¡Œã†è¨±å¯ã‚’å–å¾—</p>\\n<h5>updateToken()</h5>\\n<ul>\\n<li>Firebaseã«FCMãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜</li>\\n<li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«Pushé€šçŸ¥ã‚’é€ã‚‹åº¦ã«ã“ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å‚ç…§ã™ã‚‹ã®ã§ã€Firebaseã«ä¿å­˜ã™ã‚‹</li>\\n</ul>\\n<h5>receiveMessage()</h5>\\n<p>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡</p>\\n<br>\\n<p>â–¼ src/app/service/messaging.service.ts</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> Injectable <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'@angular/core'</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> AngularFireDatabase <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'angularfire2/database'</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> AngularFireAuth <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'angularfire2/auth'</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> BehaviorSubject <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'rxjs'</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token keyword\\\">as</span> firebase <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'firebase'</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token string\\\">'firebase/messaging'</span><span class=\\\"token punctuation\\\">;</span>\\n\\n@<span class=\\\"token function\\\">Injectable</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n  providedIn<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'root'</span><span class=\\\"token punctuation\\\">,</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">MessagingService</span> <span class=\\\"token punctuation\\\">{</span>\\n  messaging <span class=\\\"token operator\\\">=</span> firebase<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">messaging</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  currentMessage <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">BehaviorSubject</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">constructor</span><span class=\\\"token punctuation\\\">(</span>\\n    <span class=\\\"token keyword\\\">private</span> db<span class=\\\"token punctuation\\\">:</span> AngularFireDatabase<span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token keyword\\\">private</span> afAuth<span class=\\\"token punctuation\\\">:</span> AngularFireAuth\\n  <span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// Add the public key generated from the console here.</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>messaging<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">usePublicVapidKey</span><span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token string\\\">''</span> <span class=\\\"token comment\\\">// &lt;- ã“ã“ã«ã€ä¸Šè¨˜ã§ç”Ÿæˆã—ãŸéµãƒšã‚¢ã‚’è²¼ã‚Šã¤ã‘ã¦ãã ã•ã„</span>\\n    <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">updateToken</span><span class=\\\"token punctuation\\\">(</span>token<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>afAuth<span class=\\\"token punctuation\\\">.</span>authState<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">subscribe</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span>user<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">return</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n\\n      <span class=\\\"token keyword\\\">const</span> data <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token punctuation\\\">[</span>user<span class=\\\"token punctuation\\\">.</span>uid<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">:</span> token <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">object</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'fcmTokens/'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">update</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">getPermission</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>messaging\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">requestPermission</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Notification permission granted.'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>messaging<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getToken</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>token<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>token<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">updateToken</span><span class=\\\"token punctuation\\\">(</span>token<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Unable to get permission to notify.'</span><span class=\\\"token punctuation\\\">,</span> err<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">receiveMessage</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>messaging<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">onMessage</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>payload<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Message received. '</span><span class=\\\"token punctuation\\\">,</span> payload<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>currentMessage<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">next</span><span class=\\\"token punctuation\\\">(</span>payload<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<h4>2-4-3. app.module.tsã‚’ä¿®æ­£</h4>\\n<p>â–¼ src/app/app.module.ts</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token comment\\\">// ... çœç•¥ ...</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> MessagingService <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./service/messaging.service'</span><span class=\\\"token punctuation\\\">;</span>\\n\\n@<span class=\\\"token function\\\">NgModule</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token comment\\\">// ... çœç•¥ ...</span>\\n  providers<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n    MessagingService<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// â† ã‚’è¿½åŠ </span>\\n  <span class=\\\"token punctuation\\\">]</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">AppModule</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<h4>2-4-4. app.component.tsã‚’ä¿®æ­£</h4>\\n<p>â–¼ src/app/app.component.ts</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token comment\\\">// ... çœç•¥ ...</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> MessagingService <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./service/messaging.service'</span><span class=\\\"token punctuation\\\">;</span>\\n\\n@<span class=\\\"token function\\\">Component</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n  selector<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'app-root'</span><span class=\\\"token punctuation\\\">,</span>\\n  templateUrl<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'./app.component.html'</span><span class=\\\"token punctuation\\\">,</span>\\n  styleUrls<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'./app.component.scss'</span><span class=\\\"token punctuation\\\">]</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">AppComponent</span> <span class=\\\"token keyword\\\">implements</span> <span class=\\\"token class-name\\\">OnInit</span> <span class=\\\"token punctuation\\\">{</span>\\n  message<span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token keyword\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">private</span> msgService<span class=\\\"token punctuation\\\">:</span> MessagingService<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">ngOnInit</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>msgService<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getPermission</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>msgService<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">receiveMessage</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>message <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>msgService<span class=\\\"token punctuation\\\">.</span>currentMessage<span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token comment\\\">// ... çœç•¥ ...</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>ã“ã‚Œã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚¢ãƒ—ãƒªã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€</p>\\n<p>ã€Œé€šçŸ¥ã‚’è¨±å¯ã—ã¾ã™ã‹ï¼Ÿã€ã¨ã„ã†ç¢ºèªã‚¢ãƒ©ãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼ğŸ‰</p>\\n<img src=\\\"https://qiita-image-store.s3.amazonaws.com/0/128271/73bb1add-2101-7a4a-1baa-9a20059dc938.png\\\" width=\\\"30%\\\">\\n<br>\\n<h2>3. Pushæ©Ÿèƒ½å®Ÿè£…ï¼šFirebase Functionså´</h2>\\n<h3>3-1. Firebaseã®functionsã‚’åˆæœŸåŒ–ã—ã€é–¢æ•°ã‚’ä½œæˆã™ã‚‹</h3>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-cmd\\\"><code class=\\\"language-cmd\\\">firebase init functions</code></pre>\\n      </div>\\n<p>â€» ä½œæˆã®è©³ç´°æ‰‹é †ã«ã¤ã„ã¦ã¯ã€<a href=\\\"https://firebase.google.com/docs/functions/get-started?hl=ja\\\">ã“ã¡ã‚‰</a>ã‚’è¦‹ã¦ãã ã•ã„ï¼</p>\\n<br> \\n<p>åˆæœŸåŒ–ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®æ§‹æˆã«ãªã‚Šã¾ã™ï¼</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code class=\\\"language-json\\\">myproject\\n  +- .firebaserc    # Hidden file that helps you quickly switch between\\n  |                 # projects with `firebase use`\\n  |\\n  +- firebase.json  # Describes properties for your project\\n  |\\n  +- functions/     # Directory containing all your functions code\\n      |\\n      +- package.json  # npm package file describing your Cloud Functions code.\\n      |\\n      +- tsconfig.json # Config file containing compiler options.\\n      |\\n      +- tslint.json   # Optional file containing rules for TypeScript linting.\\n      |\\n      +- src/     # Directory containing TypeScript source\\n      |   |\\n      |   +- index.ts     # main source file for your Cloud Functions code\\n      |\\n      +- lib/\\n          |\\n          +- index.js     # JavaScript output from TypeScript source.\\n          |\\n          +- index.js.map # Sourcemap file for TypeScript source.\\n</code></pre>\\n      </div>\\n<p>ã“ã“ã‹ã‚‰ã¯ã€functions/src/index.ts ã‚’ä¿®æ­£ã—ã¦ã„ãã¾ã™ãƒ¼ï¼</p>\\n<h3>3-2. index.tsã‚’ä¿®æ­£</h3>\\n<p>DBã«æ›´æ–°ãŒã‚ã‚‹åº¦ã«ã€ãƒˆãƒªã‚¬ãƒ¼ã«ã‚ˆã£ã¦ <code class=\\\"language-text\\\">onCreate()</code> ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚</p>\\n<p>ã¾ãŸã€DBã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹FCMãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€ä¿¡ã™ã‚‹ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãŒä½œã‚‰ã‚Œã¾ã™ã€‚</p>\\n<p>â–¼ functions/src/index.ts</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token keyword\\\">import</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token keyword\\\">as</span> functions <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'firebase-functions'</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token keyword\\\">as</span> admin <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'firebase-admin'</span><span class=\\\"token punctuation\\\">;</span>\\nadmin<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">initializeApp</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">const</span> fcmSend <span class=\\\"token operator\\\">=</span> functions<span class=\\\"token punctuation\\\">.</span>database\\n  <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ref</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">''</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// â†ã“ã“ã¯ã€å„è‡ªã®DBæ§‹é€ ã«åˆã‚ã›ã¦å®šç¾©ã—ã¦ãã ã•ã„ï¼ˆä¾‹ï¼š/article/{articleId}ï¼‰</span>\\n  <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">onCreate</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>snapshot<span class=\\\"token punctuation\\\">,</span> context<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> articleInfo <span class=\\\"token operator\\\">=</span> snapshot<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">val</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">const</span> payload <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n      notification<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n        title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">''</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Pushãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¿ã‚¤ãƒˆãƒ«</span>\\n        body<span class=\\\"token punctuation\\\">:</span> articleInfo<span class=\\\"token punctuation\\\">.</span>title <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">'ãŒç™»éŒ²ã•ã‚Œã¾ã—ãŸ ğŸ‰'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Pushãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æœ¬æ–‡</span>\\n        clickAction<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">''</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Pushé€šçŸ¥ã‚’ã‚¿ãƒƒãƒ—ã—ãŸæ™‚ã«ã€é£›ã°ã™URLã‚’æŒ‡å®š</span>\\n        icon<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">''</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Pushé€šçŸ¥ã§ä½¿ã†ãƒ­ã‚´</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    admin\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">database</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ref</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/fcmTokens/'</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">once</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'value'</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>token<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">const</span> tokenList <span class=\\\"token operator\\\">=</span> token<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">val</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">||</span> <span class=\\\"token string\\\">''</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        Object<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">keys</span><span class=\\\"token punctuation\\\">(</span>tokenList<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">forEach</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span>key<span class=\\\"token punctuation\\\">,</span> index<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>tokenList<span class=\\\"token punctuation\\\">[</span>key<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n          admin\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">messaging</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">sendToDevice</span><span class=\\\"token punctuation\\\">(</span>tokenList<span class=\\\"token punctuation\\\">[</span>key<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span> payload<span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n              <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Sent Successfully'</span><span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n              <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>ã“ã‚Œã§å®Ÿè£…å®Œäº†ã§ã™ï¼</p>\\n<p>å®Ÿéš›ã«ã€ã“ã‚“ãªæ„Ÿã˜ã§Pushé€šçŸ¥ãŒé£›ã‚“ã§ãã¾ã™ã€‚</p>\\n<img src=\\\"https://qiita-image-store.s3.amazonaws.com/0/128271/9a5062ac-19e2-53ed-f152-720c0ba59efe.png\\\" width=\\\"30%\\\">\\n<p>ä»Šå›ã¯ã€ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€äººä¸€äººã«Pushé€šçŸ¥ã‚’é€ä¿¡ã—ã¦ã„ã¾ã™ãŒã€</p>\\n<p>è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã‚‰ã—ã„ã®ã§ã€<a href=\\\"https://firebase.google.com/docs/cloud-messaging/js/send-multiple?hl=ja\\\">ã“ã¡ã‚‰</a>ã‚‚ãœã²å‚è€ƒã«ã—ã¦ãã ã•ã„ï¼</p>\\n<br>\\n<h1>ã¾ã¨ã‚</h1>\\n<p>Firebaseæœ¬å½“æœ€é«˜ï¼ğŸ‘ğŸ‘ğŸ‘</p>\\n<br>\\n<h1>ãŠã¾ã‘</h1>\\n<p>ä»Šå›ã®å®Ÿè£…ã‚’å«ã‚ãŸå€‹äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ç™ºã—ã€é‹ç”¨ã—ã¦ã„ã¾ã™ã€‚</p>\\n<p>ã“ã®ãƒ†ãƒ¼ãƒã§ã€<a href=\\\"https://frontend-conf.fukuoka.jp/\\\">FRONTEND CONFERENCE FUKUOKA2018</a>ã§ãŠè©±ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸã€‚</p>\\n<p>ã‚¹ãƒ©ã‚¤ãƒ‰ãªã©ã‚’å…¬é–‹ã—ã¦ã¾ã™ã®ã§ã€èˆˆå‘³ã‚ã‚‹æ–¹ã¯æ˜¯éè¦‹ã¦ãã ã•ã„ï¼</p>\\n<ul>\\n<li>ãƒ†ãƒ¼ãƒï¼šAngularã¨Firebaseã§ä½œã£ãŸPWAå¯¾å¿œã‚¢ãƒ—ãƒªã§å®¶åº­å†…ã®èª²é¡Œã‚’è§£æ±ºã—ãŸè©±ã€</li>\\n<li>å…¬å¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« ï¼š<a href=\\\"https://frontend-conf.fukuoka.jp/sessions#c-6\\\">https://frontend-conf.fukuoka.jp/sessions#c-6</a></li>\\n<li>ã‚¹ãƒ©ã‚¤ãƒ‰ï¼š<a href=\\\"https://slides.com/lighthouse-dev/fec_fukuoka/#/\\\">https://slides.com/lighthouse-dev/fec_fukuoka/#/</a></li>\\n</ul>\\n<br>\\n<h1>å‚è€ƒURL</h1>\\n<ul>\\n<li><a href=\\\"https://angularfirebase.com/lessons/send-push-notifications-in-angular-with-firebase-cloud-messaging/#manifest-json\\\">https://angularfirebase.com/lessons/send-push-notifications-in-angular-with-firebase-cloud-messaging/#manifest-json</a></li>\\n<li><a href=\\\"https://firebase.google.com/docs/cloud-messaging/js/client?hl=ja\\\">https://firebase.google.com/docs/cloud-messaging/js/client?hl=ja</a></li>\\n<li><a href=\\\"https://firebase.google.com/docs/functions/get-started?hl=ja\\\">https://firebase.google.com/docs/functions/get-started?hl=ja</a></li>\\n<li><a href=\\\"https://firebase.google.com/docs/cloud-messaging/js/send-multiple?hl=ja\\\">https://firebase.google.com/docs/cloud-messaging/js/send-multiple?hl=ja</a></li>\\n</ul>\",\"fields\":{\"slug\":\"/angular-firebase-send-push-notifications/\",\"prefix\":\"2019-12-22\"},\"frontmatter\":{\"title\":\"Angular + Firebase + PWAã§Pushé€šçŸ¥æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹\",\"subTitle\":\"\",\"cover\":{\"childImageSharp\":{\"resize\":{\"src\":\"/static/firebase-logo-44b31b544b9ca3c736788200b4fd120d-160fa.png\"}}}}},\"author\":{\"id\":\"/Users/leejuseung/Work/blog/lighthouse-dev.github.io/content/parts/author.md absPath of file >>> MarkdownRemark\",\"html\":\"<p><strong>jslee</strong> <br>\\nç¦å²¡åœ¨ä½å¤–å›½ç±WEBã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ğŸ‘‹ <br>\\nPHPã‚„Vue.jsã€Angularãªã©æ›¸ã„ã¦ã¾ã™ï¼ ç„¡é¡ã®ãƒ©ãƒ¼ãƒ¡ãƒ³å¥½ãğŸœ</p>\"},\"footnote\":{\"id\":\"/Users/leejuseung/Work/blog/lighthouse-dev.github.io/content/parts/footnote.md absPath of file >>> MarkdownRemark\",\"html\":\"<ul>\\n<li><a href=\\\"../\\\">lighthouse.log</a></li>\\n</ul>\"},\"site\":{\"siteMetadata\":{\"facebook\":{\"appId\":\"152072888976323\"}}}},\"pathContext\":{\"slug\":\"/angular-firebase-send-push-notifications/\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---angular-firebase-send-push-notifications-2777da08bb9a4215c7d4.js","module.exports = {\"data\":{\"post\":{\"id\":\"/Users/leejuseung/Work/blog/lighthouse-dev.github.io/content/posts/2019-12-22--angular-firebase-send-push-notifications/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<h1>ã¯ã˜ã‚ã«</h1>\\n<p>ã“ã‚“ã«ã¡ã¯ï¼</p>\\n<p><a href=\\\"https://qiita.com/advent-calendar/2017/fusic\\\">å»å¹´</a>ã«å¼•ãç¶šãã€ä»Šå¹´ã‚‚æ›¸ãã¾ã™ã€‚</p>\\n<p><a href=\\\"https://qiita.com/advent-calendar/2018/fusic\\\">Fusic Advent Calendar 2018</a> 19æ—¥ç›®ã®è¨˜äº‹ã§ã™ï¼</p>\\n<p>ä»Šå›ã¯ã€ã€ŒAngular + Firebase + PWAã§Pushé€šçŸ¥æ©Ÿèƒ½ã‚’å®Ÿè£…ã€ã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸ ğŸ‘</p>\\n<br>\\n<h1>ã‚„ã‚ŠãŸã„ã“ã¨</h1>\\n<p>PWAã§Pushæ©Ÿèƒ½å®Ÿè£…ã—ãŸã„ï¼</p>\\n<p>â€» PWAã£ã¦ä½•ï¼Ÿçš„ãªèª¬æ˜ã¯ã€ä»¥ä¸‹ã‚’è¦‹ã¦ãã ã•ã„</p>\\n<ul>\\n<li><a href=\\\"https://developers.google.com/web/fundamentals/codelabs/your-first-pwapp/?hl=ja\\\">https://developers.google.com/web/fundamentals/codelabs/your-first-pwapp/?hl=ja</a></li>\\n<li><a href=\\\"https://developers.google.com/web/progressive-web-apps/\\\">https://developers.google.com/web/progressive-web-apps/</a></li>\\n</ul>\\n<br>\\n<h1>é–‹ç™ºç’°å¢ƒ</h1>\\n<ul>\\n<li>Angular 6</li>\\n<li>\\n<p>Firebase</p>\\n<ul>\\n<li>Realtime Database</li>\\n<li>Functions</li>\\n</ul>\\n</li>\\n</ul>\\n<br>\\n<h1>ã•ã£ããå®Ÿè£…ã«å…¥ã‚Šã¾ã—ã‚‡ã† ğŸ¤©</h1>\\n<p>å®Ÿè£…ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®æµã‚Œã§èª¬æ˜ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ï¼</p>\\n<ol>\\n<li>å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãªã©ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</li>\\n<li>Pushæ©Ÿèƒ½å®Ÿè£…ï¼šã‚¢ãƒ—ãƒªå´</li>\\n<li>Pushæ©Ÿèƒ½å®Ÿè£…ï¼šFirebase Functionså´</li>\\n</ol>\\n<h2>1. å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãªã©ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h2>\\n<p><strong>Firebase CLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-cmd\\\"><code class=\\\"language-cmd\\\">yarn global add firebase-tools@latest</code></pre>\\n      </div>\\n<p>â€» Firebase CLIã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€<a href=\\\"https://firebase.google.com/docs/cli/?hl=ja\\\">ã“ã¡ã‚‰</a>ã‚’è¦‹ã¦ä¸‹ã•ã„ï¼</p>\\n<p><strong>Firebaseãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-cmd\\\"><code class=\\\"language-cmd\\\">yarn add firebase --save</code></pre>\\n      </div>\\n<p><a href=\\\"https://www.npmjs.com/package/firebase\\\">https://www.npmjs.com/package/firebase</a></p>\\n<br>\\n<h2>2. Pushæ©Ÿèƒ½å®Ÿè£…ï¼šã‚¢ãƒ—ãƒªå´</h2>\\n<h3>2-1. manifest.jsonã‚’ä¿®æ­£</h3>\\n<p>ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰å€¤ <code class=\\\"language-text\\\">gcm_sender_id</code> ã‚’æŒ‡å®šã™ã‚‹ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒª ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>\\n<blockquote>\\n<p>ã€Œãƒ–ãƒ©ã‚¦ã‚¶é€ä¿¡è€… IDã€ã¨ã€Firebase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šã«ç¤ºã•ã‚Œã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®é€ä¿¡è€… ID å€¤ã¨ã‚’æ··åŒã—ãªã„ã§ãã ã•ã„ã€‚\\nmanifest.json ã®ãƒ–ãƒ©ã‚¦ã‚¶é€ä¿¡è€… ID ã¯å›ºå®šå€¤ã§ã€ã™ã¹ã¦ã® FCM JavaScript ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§å…±é€šã§ã™ã€‚</p>\\n</blockquote>\\n<p> <code class=\\\"language-text\\\">gcm_sender_id</code>ã¯ã€å›ºå®šå€¤ã§ã™ã®ã§ã€å¤‰æ›´ã—ãªã„ã§ãã ã•ã„ï¼</p>\\n<p>â–¼ src/manifest.json</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code class=\\\"language-json\\\"><span class=\\\"token punctuation\\\">{</span>\\n  ... çœç•¥ ...\\n  <span class=\\\"token property\\\">\\\"gcm_sender_id\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"103953800507\\\"</span> // â† gcm_sender_idã‚’è¿½åŠ \\n  ... çœç•¥ ...\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<h3>2-2. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚’ä½œæˆ</h3>\\n<p>Pushãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã¯ã€ <code class=\\\"language-text\\\">service worker</code> ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚\\nã¾ãšã€Firebaseã§ <code class=\\\"language-text\\\">messagingSenderId</code>ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚\\nj</p>\\n\\n  <a class=\\\"gatsby-resp-image-link\\\" href=\\\"/static/image-1-2942bf1f0d78ee14e610bf7e0b5d43b9-6eb54.png\\\" style=\\\"display: block\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\">\\n  \\n  <span class=\\\"gatsby-resp-image-wrapper\\\" style=\\\"position: relative; display: block; margin-left: 0 !important; max-width: 800px; margin-left: auto; margin-right: auto;\\\">\\n    <span class=\\\"gatsby-resp-image-background-image\\\" style=\\\"padding-bottom: 74.63330457290768%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACo0lEQVQ4y5WTy24SURjHeQJ9AVcmWvsYLurGbWtStY0bbQXKDMMwUBtsNKm00tobt6YwMDPMDWa4VgreEo3v9fc7B0qLrQsXv3zn+j/f7QRuPRZwmwjMhUc8+k/m/mLxhYynK0ncWxAw+0TAA8ZChDMzH7kcE7Nje3/+khm+JkwIrIkSgkIMkajMEaQ4xJiCKCHFk5yonCCUaWIjK9J5fm98PxAUZITEEa/CIra2MzAtC5puoFRWUVZVGDUTbr0Ox53G830cZfPkBHt8nR5IMsEY95ALhkRkPh3g7KyHVqsFv9lEs9VEu91Gp9PhtDvjcbeLwWCA01KZIkpAVt4gRqIBJnQhuEIeftghD80GLMOEZRGOzanZ1sSatk1ROPA8D9lcnsL/hyALOZ3Zg1rRcFIoQjcMaDUD5ZoG3apBNw3YjoM6he+6LhqeT4KFmwXDZF+S4H5mF75eReWkCN+1SECHY5EgiVZqOs3tieB5x6eHR4LxxMZNglEcpnfwXdcwqFbw1dDwzTbw0zXh2SYVgrwjISbmkKdKsY7NvRxEVmUSZcW5nkMK2W54PE8WXTJsF4bboDUfVt2DS3s+VZflL621sHWQRzASnXTKpYfRUZX39g9x3v/Mq3zW68HpDqA1+9BbfXi9c3wZDjEcDtDt9/H71w+o1Sr1n8JzKLG2uerh6pqEjbfvkMsXeLKZPcgWkD7M4YjmBSrUx+Msty21jNpREYWdXcgkNFWUadEowjRm+YgRS2EJd5+tIijGCRl3lhaxHFqDmt7G8cNVlF6nkEqlqKnXr7fNxZh1PauaktxAhESXgwL3gFXzeTCMEJ3Zfb+F0/0TlCiHqcQ6JNqXr3oYGosGx96xb8R+gMi+Ff/fCY5Ec2aTtLapJLApjyIRx+f/AANl6wIhgsLkAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\\\">\\n      <img class=\\\"gatsby-resp-image-image\\\" style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\" alt=\\\"image 1\\\" title=\\\"\\\" src=\\\"/static/image-1-2942bf1f0d78ee14e610bf7e0b5d43b9-40b6f.png\\\" srcset=\\\"/static/image-1-2942bf1f0d78ee14e610bf7e0b5d43b9-9039c.png 200w,\\n/static/image-1-2942bf1f0d78ee14e610bf7e0b5d43b9-9db44.png 400w,\\n/static/image-1-2942bf1f0d78ee14e610bf7e0b5d43b9-40b6f.png 800w,\\n/static/image-1-2942bf1f0d78ee14e610bf7e0b5d43b9-6eb54.png 1159w\\\" sizes=\\\"(max-width: 800px) 100vw, 800px\\\">\\n    </span>\\n  </span>\\n  \\n  </a>\\n    \\n<p>æ¬¡ã¯ã€<code class=\\\"language-text\\\">src</code>ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®é…ä¸‹ã« <code class=\\\"language-text\\\">firebase-messaging-sw.js</code> ã‚’ä½œæˆã—ã¾ã™ã€‚</p>\\n<p>ãã—ã¦ã€â†‘ã§ã‚³ãƒ”ãƒ¼ã—ãŸ<code class=\\\"language-text\\\">messagingSenderId</code> ã‚’ã€ä»¥ä¸‹ã® <code class=\\\"language-text\\\">firebase.initializeApp()</code> ã«è²¼ã‚Šã¤ã‘ã¾ã™ï¼</p>\\n<p>â–¼ src/firebase-messaging-sw.js</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token comment\\\">// Give the service worker access to Firebase Messaging.</span>\\n<span class=\\\"token comment\\\">// Note that you can only use Firebase Messaging here, other Firebase libraries</span>\\n<span class=\\\"token comment\\\">// are not available in the service worker.</span>\\n<span class=\\\"token function\\\">importScripts</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'https://www.gstatic.com/firebasejs/5.5.0/firebase-app.js'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token function\\\">importScripts</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'https://www.gstatic.com/firebasejs/5.5.0/firebase-messaging.js'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    \\n<span class=\\\"token comment\\\">// Initialize the Firebase app in the service worker by passing in the</span>\\n<span class=\\\"token comment\\\">// messagingSenderId.</span>\\nfirebase<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">initializeApp</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n  messagingSenderId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">''</span> <span class=\\\"token comment\\\">// â†‘ã§ã‚³ãƒ”ãƒ¼ã—ãŸmessagingSenderIdã‚’è¿½åŠ </span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    \\n<span class=\\\"token comment\\\">// Retrieve an instance of Firebase Messaging so that it can handle background</span>\\n<span class=\\\"token comment\\\">// messages.</span>\\n<span class=\\\"token keyword\\\">const</span> messaging <span class=\\\"token operator\\\">=</span> firebase<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">messaging</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmessaging<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setBackgroundMessageHandler</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span>payload<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">const</span> notificationTitle <span class=\\\"token operator\\\">=</span> payload<span class=\\\"token punctuation\\\">.</span>notification<span class=\\\"token punctuation\\\">.</span>title<span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">const</span> notificationOptions <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n    body<span class=\\\"token punctuation\\\">:</span> payload<span class=\\\"token punctuation\\\">.</span>notification<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">,</span>\\n    icon<span class=\\\"token punctuation\\\">:</span> payload<span class=\\\"token punctuation\\\">.</span>notification<span class=\\\"token punctuation\\\">.</span>icon\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token keyword\\\">return</span> self<span class=\\\"token punctuation\\\">.</span>registration<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">showNotification</span><span class=\\\"token punctuation\\\">(</span>notificationTitle<span class=\\\"token punctuation\\\">,</span> notificationOptions<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\nself<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">addEventListener</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'install'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span>event<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Service Worker installing.'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\nself<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">addEventListener</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'activate'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span>event<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Service Worker activating.'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>ã“ã‚Œã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ãƒ—ãƒªã‚’é–‰ã˜ã¦ã‚‚ã€ã‚¢ãƒ—ãƒªãŒæ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ¤œçŸ¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼</p>\\n<h3>2-3. angular.jsonã‚’ä¿®æ­£</h3>\\n<p>angular.jsonã«<code class=\\\"language-text\\\">manifest.json</code>, <code class=\\\"language-text\\\">firebase-messaging-sw.js</code> ã‚’è¿½åŠ </p>\\n<p>â–¼ angular.json</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code class=\\\"language-json\\\"><span class=\\\"token punctuation\\\">{</span>\\n  ... çœç•¥ ...\\n  <span class=\\\"token property\\\">\\\"projects\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token property\\\">\\\"architect\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token property\\\">\\\"build\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">\\\"options\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token property\\\">\\\"assets\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n            <span class=\\\"token string\\\">\\\"src/favicon.ico\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n            <span class=\\\"token string\\\">\\\"src/assets\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n            <span class=\\\"token string\\\">\\\"src/manifest.json\\\"</span><span class=\\\"token punctuation\\\">,</span> // â†è¿½åŠ \\n            <span class=\\\"token string\\\">\\\"src/firebase-messaging-sw.js\\\"</span> // â†è¿½åŠ \\n          <span class=\\\"token punctuation\\\">]</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<h3>2-4. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œæˆ</h3>\\n<p>ã¾ãšã¯ã€Firebaseã®ã€Œéµãƒšã‚¢ã€ã‚’ç”Ÿæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>\\n<h4>2-4-1. Firebaseã§ã€Œéµãƒšã‚¢ã€ã‚’ç”Ÿæˆ</h4>\\n<p>ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šï¼ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã€ã«å…¥ã£ã¦ã€éµãƒšã‚¢ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚</p>\\n\\n  <a class=\\\"gatsby-resp-image-link\\\" href=\\\"/static/image-2-694ee39e36a729fdf3a2bde5a0a1977e-4dcde.png\\\" style=\\\"display: block\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\">\\n  \\n  <span class=\\\"gatsby-resp-image-wrapper\\\" style=\\\"position: relative; display: block; margin-left: 0 !important; max-width: 800px; margin-left: auto; margin-right: auto;\\\">\\n    <span class=\\\"gatsby-resp-image-background-image\\\" style=\\\"padding-bottom: 78.64493996569468%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACOElEQVQ4y6WTy2oUQRSGWwTXgiufRHDvzncQ3JgYjBPxtowJiQYRFJlkQhgcTYaZ6a5rd1VfjKMufK/fc6ovdCYiiIuPv8/p7r9O1TkVXXt0imj9M6KHXxBtnOHKxul/Ed0czHH9icKNQYyra2S8flazxgs1rPV0lQc9ON4/0did5Ngbp3h5uMDmYYLHQ9JhjC16HnBMbB3Vujm8yNNRghfHCZ6N6veRMQpGS0IhtQaO4lQJZJTLU9Phrb4Q5/RtSTqeK7ydCBxNJTKjEc2FRsssUUiUhrYW2lgobSApZm3jFkkYY/BqLHH/Q4LnxwJT+j+KpUbLQijYNIX3HnmeB1VKQQgRlNFaB6M2XpY5fi0r/KgKJOTRGKrO0FAlKZk654JhlmUhZmX6i9WawxGZ88HjkmHYjqTzIEM2dfQj/+xanK/zK/BinSEbMfw8TyRmsehy/0pn2KmQdBYyNEM2Dairyxs80swF2pz/25YNHbqjEeERcKZWxR1u0RaCFmNW85e2zF16N4mxfRJj75PAzljgDc1YrOoxEaSCDQnZaAe9WzHUYQzuvY9xe2eOO/sL3Nqe4e5BDGlTmkOaO5rPsiyRM0WJgrpcFEwROv7HsXF0A869xVfX4FNYyvG2TJqFjn7PLb5luhulllBhv8Os3Ay+FVyRMvUN8bR6SVUUVFlJzXg9+4mD6RIFNYJzXCF/02uK7s2hpopsGHC+EbbZZlVVtNWKbpLHx8U5RguKqdqS8vyuoCNgj99yop6cK27sYQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\\\">\\n      <img class=\\\"gatsby-resp-image-image\\\" style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\" alt=\\\"image 2\\\" title=\\\"\\\" src=\\\"/static/image-2-694ee39e36a729fdf3a2bde5a0a1977e-40b6f.png\\\" srcset=\\\"/static/image-2-694ee39e36a729fdf3a2bde5a0a1977e-9039c.png 200w,\\n/static/image-2-694ee39e36a729fdf3a2bde5a0a1977e-9db44.png 400w,\\n/static/image-2-694ee39e36a729fdf3a2bde5a0a1977e-40b6f.png 800w,\\n/static/image-2-694ee39e36a729fdf3a2bde5a0a1977e-4dcde.png 1166w\\\" sizes=\\\"(max-width: 800px) 100vw, 800px\\\">\\n    </span>\\n  </span>\\n  \\n  </a>\\n    \\n<p>ç”Ÿæˆã—ãŸéµãƒšã‚¢ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãŠã„ã¦ãã ã•ã„â­ï¸</p>\\n<h4>2-4-2. Serviceä½œæˆ</h4>\\n<p>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€Pushé€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘å–ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¨±å¯ã‚’å¾—ã‚‹å½¹å‰²ã‚’ã—ã¾ã™ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-cmd\\\"><code class=\\\"language-cmd\\\">ng g service messaging</code></pre>\\n      </div>\\n<p>ã–ã£ãã‚Šä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹æˆã«ãªã‚Šã¾ã™ï¼</p>\\n<h5>getPermission()</h5>\\n<p>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰Pushé€šçŸ¥ã‚’è¡Œã†è¨±å¯ã‚’å–å¾—</p>\\n<h5>updateToken()</h5>\\n<ul>\\n<li>Firebaseã«FCMãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜</li>\\n<li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«Pushé€šçŸ¥ã‚’é€ã‚‹åº¦ã«ã“ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å‚ç…§ã™ã‚‹ã®ã§ã€Firebaseã«ä¿å­˜ã™ã‚‹</li>\\n</ul>\\n<h5>receiveMessage()</h5>\\n<p>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡</p>\\n<br>\\n<p>â–¼ src/app/service/messaging.service.ts</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> Injectable <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'@angular/core'</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> AngularFireDatabase <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'angularfire2/database'</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> AngularFireAuth <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'angularfire2/auth'</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> BehaviorSubject <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'rxjs'</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token keyword\\\">as</span> firebase <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'firebase'</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token string\\\">'firebase/messaging'</span><span class=\\\"token punctuation\\\">;</span>\\n\\n@<span class=\\\"token function\\\">Injectable</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n  providedIn<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'root'</span><span class=\\\"token punctuation\\\">,</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">MessagingService</span> <span class=\\\"token punctuation\\\">{</span>\\n  messaging <span class=\\\"token operator\\\">=</span> firebase<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">messaging</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  currentMessage <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">BehaviorSubject</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">constructor</span><span class=\\\"token punctuation\\\">(</span>\\n    <span class=\\\"token keyword\\\">private</span> db<span class=\\\"token punctuation\\\">:</span> AngularFireDatabase<span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token keyword\\\">private</span> afAuth<span class=\\\"token punctuation\\\">:</span> AngularFireAuth\\n  <span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// Add the public key generated from the console here.</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>messaging<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">usePublicVapidKey</span><span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token string\\\">''</span> <span class=\\\"token comment\\\">// &lt;- ã“ã“ã«ã€ä¸Šè¨˜ã§ç”Ÿæˆã—ãŸéµãƒšã‚¢ã‚’è²¼ã‚Šã¤ã‘ã¦ãã ã•ã„</span>\\n    <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">updateToken</span><span class=\\\"token punctuation\\\">(</span>token<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>afAuth<span class=\\\"token punctuation\\\">.</span>authState<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">subscribe</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span>user<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">return</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n\\n      <span class=\\\"token keyword\\\">const</span> data <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token punctuation\\\">[</span>user<span class=\\\"token punctuation\\\">.</span>uid<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">:</span> token <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">object</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'fcmTokens/'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">update</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">getPermission</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>messaging\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">requestPermission</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Notification permission granted.'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>messaging<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getToken</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>token<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>token<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">updateToken</span><span class=\\\"token punctuation\\\">(</span>token<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Unable to get permission to notify.'</span><span class=\\\"token punctuation\\\">,</span> err<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">receiveMessage</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>messaging<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">onMessage</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>payload<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Message received. '</span><span class=\\\"token punctuation\\\">,</span> payload<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>currentMessage<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">next</span><span class=\\\"token punctuation\\\">(</span>payload<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<h4>2-4-3. app.module.tsã‚’ä¿®æ­£</h4>\\n<p>â–¼ src/app/app.module.ts</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token comment\\\">// ... çœç•¥ ...</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> MessagingService <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./service/messaging.service'</span><span class=\\\"token punctuation\\\">;</span>\\n\\n@<span class=\\\"token function\\\">NgModule</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token comment\\\">// ... çœç•¥ ...</span>\\n  providers<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n    MessagingService<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// â† ã‚’è¿½åŠ </span>\\n  <span class=\\\"token punctuation\\\">]</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">AppModule</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<h4>2-4-4. app.component.tsã‚’ä¿®æ­£</h4>\\n<p>â–¼ src/app/app.component.ts</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token comment\\\">// ... çœç•¥ ...</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> MessagingService <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./service/messaging.service'</span><span class=\\\"token punctuation\\\">;</span>\\n\\n@<span class=\\\"token function\\\">Component</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n  selector<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'app-root'</span><span class=\\\"token punctuation\\\">,</span>\\n  templateUrl<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'./app.component.html'</span><span class=\\\"token punctuation\\\">,</span>\\n  styleUrls<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">'./app.component.scss'</span><span class=\\\"token punctuation\\\">]</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">AppComponent</span> <span class=\\\"token keyword\\\">implements</span> <span class=\\\"token class-name\\\">OnInit</span> <span class=\\\"token punctuation\\\">{</span>\\n  message<span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token keyword\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">private</span> msgService<span class=\\\"token punctuation\\\">:</span> MessagingService<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">ngOnInit</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>msgService<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getPermission</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>msgService<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">receiveMessage</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>message <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>msgService<span class=\\\"token punctuation\\\">.</span>currentMessage<span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token comment\\\">// ... çœç•¥ ...</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>ã“ã‚Œã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚¢ãƒ—ãƒªã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€</p>\\n<p>ã€Œé€šçŸ¥ã‚’è¨±å¯ã—ã¾ã™ã‹ï¼Ÿã€ã¨ã„ã†ç¢ºèªã‚¢ãƒ©ãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼ğŸ‰</p>\\n<img src=\\\"https://qiita-image-store.s3.amazonaws.com/0/128271/73bb1add-2101-7a4a-1baa-9a20059dc938.png\\\" width=\\\"30%\\\">\\n<br>\\n<h2>3. Pushæ©Ÿèƒ½å®Ÿè£…ï¼šFirebase Functionså´</h2>\\n<h3>3-1. Firebaseã®functionsã‚’åˆæœŸåŒ–ã—ã€é–¢æ•°ã‚’ä½œæˆã™ã‚‹</h3>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-cmd\\\"><code class=\\\"language-cmd\\\">firebase init functions</code></pre>\\n      </div>\\n<p>â€» ä½œæˆã®è©³ç´°æ‰‹é †ã«ã¤ã„ã¦ã¯ã€<a href=\\\"https://firebase.google.com/docs/functions/get-started?hl=ja\\\">ã“ã¡ã‚‰</a>ã‚’è¦‹ã¦ãã ã•ã„ï¼</p>\\n<br> \\n<p>åˆæœŸåŒ–ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®æ§‹æˆã«ãªã‚Šã¾ã™ï¼</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code class=\\\"language-json\\\">myproject\\n  +- .firebaserc    # Hidden file that helps you quickly switch between\\n  |                 # projects with `firebase use`\\n  |\\n  +- firebase.json  # Describes properties for your project\\n  |\\n  +- functions/     # Directory containing all your functions code\\n      |\\n      +- package.json  # npm package file describing your Cloud Functions code.\\n      |\\n      +- tsconfig.json # Config file containing compiler options.\\n      |\\n      +- tslint.json   # Optional file containing rules for TypeScript linting.\\n      |\\n      +- src/     # Directory containing TypeScript source\\n      |   |\\n      |   +- index.ts     # main source file for your Cloud Functions code\\n      |\\n      +- lib/\\n          |\\n          +- index.js     # JavaScript output from TypeScript source.\\n          |\\n          +- index.js.map # Sourcemap file for TypeScript source.\\n</code></pre>\\n      </div>\\n<p>ã“ã“ã‹ã‚‰ã¯ã€functions/src/index.ts ã‚’ä¿®æ­£ã—ã¦ã„ãã¾ã™ãƒ¼ï¼</p>\\n<h3>3-2. index.tsã‚’ä¿®æ­£</h3>\\n<p>DBã«æ›´æ–°ãŒã‚ã‚‹åº¦ã«ã€ãƒˆãƒªã‚¬ãƒ¼ã«ã‚ˆã£ã¦ <code class=\\\"language-text\\\">onCreate()</code> ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚</p>\\n<p>ã¾ãŸã€DBã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹FCMãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€ä¿¡ã™ã‚‹ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãŒä½œã‚‰ã‚Œã¾ã™ã€‚</p>\\n<p>â–¼ functions/src/index.ts</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token keyword\\\">import</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token keyword\\\">as</span> functions <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'firebase-functions'</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token keyword\\\">as</span> admin <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'firebase-admin'</span><span class=\\\"token punctuation\\\">;</span>\\nadmin<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">initializeApp</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">const</span> fcmSend <span class=\\\"token operator\\\">=</span> functions<span class=\\\"token punctuation\\\">.</span>database\\n  <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ref</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">''</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// â†ã“ã“ã¯ã€å„è‡ªã®DBæ§‹é€ ã«åˆã‚ã›ã¦å®šç¾©ã—ã¦ãã ã•ã„ï¼ˆä¾‹ï¼š/article/{articleId}ï¼‰</span>\\n  <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">onCreate</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>snapshot<span class=\\\"token punctuation\\\">,</span> context<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> articleInfo <span class=\\\"token operator\\\">=</span> snapshot<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">val</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">const</span> payload <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n      notification<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n        title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">''</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Pushãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¿ã‚¤ãƒˆãƒ«</span>\\n        body<span class=\\\"token punctuation\\\">:</span> articleInfo<span class=\\\"token punctuation\\\">.</span>title <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">'ãŒç™»éŒ²ã•ã‚Œã¾ã—ãŸ ğŸ‰'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Pushãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æœ¬æ–‡</span>\\n        clickAction<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">''</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Pushé€šçŸ¥ã‚’ã‚¿ãƒƒãƒ—ã—ãŸæ™‚ã«ã€é£›ã°ã™URLã‚’æŒ‡å®š</span>\\n        icon<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">''</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Pushé€šçŸ¥ã§ä½¿ã†ãƒ­ã‚´</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    admin\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">database</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ref</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/fcmTokens/'</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">once</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'value'</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>token<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">const</span> tokenList <span class=\\\"token operator\\\">=</span> token<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">val</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">||</span> <span class=\\\"token string\\\">''</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        Object<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">keys</span><span class=\\\"token punctuation\\\">(</span>tokenList<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">forEach</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span>key<span class=\\\"token punctuation\\\">,</span> index<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>tokenList<span class=\\\"token punctuation\\\">[</span>key<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n          admin\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">messaging</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">sendToDevice</span><span class=\\\"token punctuation\\\">(</span>tokenList<span class=\\\"token punctuation\\\">[</span>key<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span> payload<span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n              <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Sent Successfully'</span><span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n              <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token builtin\\\">console</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>ã“ã‚Œã§å®Ÿè£…å®Œäº†ã§ã™ï¼</p>\\n<p>å®Ÿéš›ã«ã€ã“ã‚“ãªæ„Ÿã˜ã§Pushé€šçŸ¥ãŒé£›ã‚“ã§ãã¾ã™ã€‚</p>\\n<img src=\\\"https://qiita-image-store.s3.amazonaws.com/0/128271/9a5062ac-19e2-53ed-f152-720c0ba59efe.png\\\" width=\\\"30%\\\">\\n<p>ä»Šå›ã¯ã€ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€äººä¸€äººã«Pushé€šçŸ¥ã‚’é€ä¿¡ã—ã¦ã„ã¾ã™ãŒã€</p>\\n<p>è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã‚‰ã—ã„ã®ã§ã€<a href=\\\"https://firebase.google.com/docs/cloud-messaging/js/send-multiple?hl=ja\\\">ã“ã¡ã‚‰</a>ã‚‚ãœã²å‚è€ƒã«ã—ã¦ãã ã•ã„ï¼</p>\\n<br>\\n<h1>ã¾ã¨ã‚</h1>\\n<p>Firebaseæœ¬å½“æœ€é«˜ï¼ğŸ‘ğŸ‘ğŸ‘</p>\\n<br>\\n<h1>ãŠã¾ã‘</h1>\\n<p>ä»Šå›ã®å®Ÿè£…ã‚’å«ã‚ãŸå€‹äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ç™ºã—ã€é‹ç”¨ã—ã¦ã„ã¾ã™ã€‚</p>\\n<p>ã“ã®ãƒ†ãƒ¼ãƒã§ã€<a href=\\\"https://frontend-conf.fukuoka.jp/\\\">FRONTEND CONFERENCE FUKUOKA2018</a>ã§ãŠè©±ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸã€‚</p>\\n<p>ã‚¹ãƒ©ã‚¤ãƒ‰ãªã©ã‚’å…¬é–‹ã—ã¦ã¾ã™ã®ã§ã€èˆˆå‘³ã‚ã‚‹æ–¹ã¯æ˜¯éè¦‹ã¦ãã ã•ã„ï¼</p>\\n<ul>\\n<li>ãƒ†ãƒ¼ãƒï¼šAngularã¨Firebaseã§ä½œã£ãŸPWAå¯¾å¿œã‚¢ãƒ—ãƒªã§å®¶åº­å†…ã®èª²é¡Œã‚’è§£æ±ºã—ãŸè©±ã€</li>\\n<li>å…¬å¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« ï¼š<a href=\\\"https://frontend-conf.fukuoka.jp/sessions#c-6\\\">https://frontend-conf.fukuoka.jp/sessions#c-6</a></li>\\n<li>ã‚¹ãƒ©ã‚¤ãƒ‰ï¼š<a href=\\\"https://slides.com/lighthouse-dev/fec_fukuoka/#/\\\">https://slides.com/lighthouse-dev/fec_fukuoka/#/</a></li>\\n</ul>\\n<br>\\n<h1>å‚è€ƒURL</h1>\\n<ul>\\n<li><a href=\\\"https://angularfirebase.com/lessons/send-push-notifications-in-angular-with-firebase-cloud-messaging/#manifest-json\\\">https://angularfirebase.com/lessons/send-push-notifications-in-angular-with-firebase-cloud-messaging/#manifest-json</a></li>\\n<li><a href=\\\"https://firebase.google.com/docs/cloud-messaging/js/client?hl=ja\\\">https://firebase.google.com/docs/cloud-messaging/js/client?hl=ja</a></li>\\n<li><a href=\\\"https://firebase.google.com/docs/functions/get-started?hl=ja\\\">https://firebase.google.com/docs/functions/get-started?hl=ja</a></li>\\n<li><a href=\\\"https://firebase.google.com/docs/cloud-messaging/js/send-multiple?hl=ja\\\">https://firebase.google.com/docs/cloud-messaging/js/send-multiple?hl=ja</a></li>\\n</ul>\",\"fields\":{\"slug\":\"/angular-firebase-send-push-notifications/\",\"prefix\":\"2019-12-22\"},\"frontmatter\":{\"title\":\"Angular + Firebase + PWAã§Pushé€šçŸ¥æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹\",\"subTitle\":\"\",\"cover\":{\"childImageSharp\":{\"resize\":{\"src\":\"/static/firebase-logo-44b31b544b9ca3c736788200b4fd120d-160fa.png\"}}}}},\"author\":{\"id\":\"/Users/leejuseung/Work/blog/lighthouse-dev.github.io/content/parts/author.md absPath of file >>> MarkdownRemark\",\"html\":\"<p><strong>jslee</strong> <br>\\nç¦å²¡åœ¨ä½å¤–å›½ç±WEBã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ğŸ‘‹ <br>\\nPHPã‚„Vue.jsã€Angularãªã©æ›¸ã„ã¦ã¾ã™ï¼ ç„¡é¡ã®ãƒ©ãƒ¼ãƒ¡ãƒ³å¥½ãğŸœ</p>\"},\"footnote\":{\"id\":\"/Users/leejuseung/Work/blog/lighthouse-dev.github.io/content/parts/footnote.md absPath of file >>> MarkdownRemark\",\"html\":\"<ul>\\n<li><a href=\\\"../\\\">lighthouse.log</a></li>\\n</ul>\"},\"site\":{\"siteMetadata\":{\"facebook\":{\"appId\":\"152072888976323\"}}}},\"pathContext\":{\"slug\":\"/angular-firebase-send-push-notifications/\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/angular-firebase-send-push-notifications.json\n// module id = 874\n// module chunks = 248565452126349"],"sourceRoot":""}